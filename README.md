# macropad_to_gamepad

I Have:
- Elite Dangerous
- A left VKB joystick
- A right VKB joystick
- A Koolertron AE-SMKD / LingYao ShangHai Thumb Keyboard
  - Based on the CY8C24794-24LTXI
  - 46 programmable keys
  - not the current model
- A need for even more buttons
- Linux
- Steam
- Proton
- Python 3

They say F13 through F24 make good macro keys. They are not quite right - /usr/share/X11/xkb/symbols/inet reserves them all for stuff like enabling/disabling/toggling touchpad. 

They work with Modifiers. Meta+F13 (looks like Win+F13 if it actually existed), Alt+F13, Ctrl+F13, Shift+F13 - 48 single mod keys.

Which Elite Dangerous will ignore. So This script
- Finds your macropad with F13 mapped, lest it select the emulated mouse you aren't using
- Creates a virtual Joystick named after it
- Emits button presses in the BTN_TRIGGER_HAPPY1 linux kernel event range, lest your button orders com out different than your FKEY orders
- Checks your Binds file that all the mentioned joysicks are attached, including the virtual ones

THANKS UTILITIES
- `jstest-gtk /dev/input/js2`
- `evtest`
- `libinput list-devices`
- `dmesg`

THANKS WALLED GARDEN
- I can't copyright this because nothing generated by ChatGPT can be copyrighted
- Could I have done this based on StackOverflow et.al. Posts before the place was torched by people (appropriately) mad the robot's crawl wasn't authorized, but was monitized, so now their posts only exist in it's learning data archive? Possibly.
- Discord though? No chance in Hell. Might as well be propriatary company secrets at that point.

ADDITIONAL NOTES
- If the CY8C24794 wasn't so old, sure I could try properly programming it as an HID joystick device. But I'm not whatchacall *good*. psoc designer is beyond me. Also [QMK developers](https://github.com/qmk/qmk_firmware/issues/6536).
- Manually existing the binds file to change `<Primary Device="Keyboard" Key="Key_W" />` to `<Primary Device="04B40818" Key="Key_W" />` is corrupting the file, according to the parser. It creates a log file in the custom binds directory.
- JoystickGremlin is Windows. VoiceAttack is Windows. Thank you python programmers who write things that aren't windows only.
- Koolertron specific
  - https://www.koolertron.com/user-manual-software-download
  - http://amazonfiles.s3.amazonaws.com/smkd72.rar (archived here)
  - http://www.smartyao.com/page91?_l=en
  - http://dme657285d3.pic11.websiteonline.cn/upload/TK_V521_En_230221.rar (archived here)
  - FKEY_and_modifiers_profile.bin is a layout for the 46 key version, 44 and 48 key versions exist and will need a little more work

